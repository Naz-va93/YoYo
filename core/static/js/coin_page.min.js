document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("progressBar"),t=document.getElementById("todayLowPrice"),i=document.getElementById("todayHighPrice"),r=parseFloat(e.getAttribute("data-current-price").replace(",",".")),o=document.getElementById("coin__converter-from"),n=document.getElementById("coin__converter-to");function a(){let e=parseFloat(o.getAttribute("data-coin-price-usd").replace(",",".")),t=parseFloat(o.getAttribute("data-coin-price-currency-to-usd").replace(",",".")),i=s(o.value),r=document.getElementById("current-currency").innerText.toLowerCase(),a=document.getElementById("converter-crypto-symbol").innerText.toLowerCase();if(console.log(r,a),r===a){n.value=l(i);return}n.value=l((i||0)*e*t)}function s(e){if(!/^[0-9\s,.]+$/.test(e))return 0;{e=(e=e.replace(/\s+/g,"")).replace(/,/g,".");let t=parseFloat(e);return isNaN(t)?0:t}}function l(e){if("string"==typeof e&&(e=parseFloat(e)),isNaN(e)||0===e)return"0";let t=Math.abs(e),i=2;0!==t&&t<1&&(i=-Math.floor(Math.log10(t))+2);let r=e.toLocaleString("en-US",{minimumFractionDigits:i,maximumFractionDigits:i,useGrouping:!0}).replace(/,/g," ").replace(/\./g,",");return r.replace(/(\,\d*[1-9])0+$|\,0*$/,"$1").replace(/,/g,".")}n.value=l(parseFloat(o.getAttribute("data-coin-price-usd").replace(",","."))),o.addEventListener("input",function(){a()}),n.addEventListener("input",function(){(function e(){let t=parseFloat(o.getAttribute("data-coin-price-usd").replace(",",".")),i=parseFloat(o.getAttribute("data-coin-price-currency-to-usd").replace(",",".")),r=s(n.value),a=document.getElementById("current-currency").innerText.toLowerCase(),c=document.getElementById("converter-crypto-symbol").innerText.toLowerCase();if(a===c){o.value=l(r);return}o.value=l((r||0)/i/t)})()});let c=document.querySelector(".coin__trading--coin__info"),d=document.querySelector(".coin__chart"),p=document.querySelectorAll(".coin__tab.market_price"),u=document.getElementById("coin__tab-container-history_price");p.forEach(e=>{e.addEventListener("click",function(t){!function e(t,i,r){1===i&&(d.classList.add("visually-hidden"),u.classList.add("visually-hidden"),c.classList.remove("visually-hidden")),0===i&&(c.classList.add("visually-hidden"),d.classList.remove("visually-hidden"),u.classList.remove("visually-hidden")),t.forEach(e=>{e.classList.remove("active")}),r.target.classList.add("active");let o=r.target.offsetWidth;document.querySelector(".coin__slider").style.transform=`translateX(${i*o}px)`}(p,parseInt(e.getAttribute("data-index")),t)})});let y=document.querySelectorAll(".coin__tab.history_price"),m=null;y.forEach(o=>{o.addEventListener("click",function(n){(function o(n,a,s,c,d){a.forEach(e=>{e.classList.remove("active")}),n.target.classList.add("active");let p=document.querySelector(".coin__chart-wrapper.period"),u=p.querySelector("canvas");u&&(m&&m.destroy(),p.removeChild(u)),(u=document.createElement("canvas")).id="coinChartHistoryPrice",p.appendChild(u);let y=u.getContext("2d"),g=y.createLinearGradient(0,0,0,400);g.addColorStop(0,"rgba(30, 116, 254, 0.4)"),g.addColorStop(.78966,"rgba(30, 116, 254, 0)"),fetch(`https://coinyoyo.io/coin-price-history?coinId=${c}&type=${d}&period=${s}`).then(e=>e.json()).then(o=>{if(y.clearRect(0,0,u.width,u.height),"success"===o.status){let n=o.data.history;n.sort((e,t)=>e.timestamp-t.timestamp);let a=n.filter(e=>null!==e.price),c=a.map(e=>e.price),d=a.map(e=>{let t=new Date(1e3*e.timestamp);return"24h"===s?t.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1}):t.toLocaleDateString("en-GB")});function p(){let e=window.innerWidth<600;m&&m.options&&m.options.scales&&m.options.scales.x&&(m.options.scales.x.ticks.maxTicksLimit=e?4:6,m.update())}if(m=new Chart(y,{type:"line",data:{labels:d,datasets:[{data:c,borderColor:"#3c86fe",borderWidth:2,fill:!0,pointRadius:0,pointHoverRadius:0,lineTension:.1,backgroundColor:g}]},options:{responsive:!1,animation:{duration:0},interaction:{mode:"nearest",axis:"x",intersect:!1},plugins:{legend:{display:!1},tooltip:{enabled:!0,mode:"index",intersect:!1,displayColors:!1,callbacks:{label:function(e){return l(e.raw)}}},crosshair:{line:{color:"#282b31",width:1},zoom:{enabled:!1}}},scales:{y:{ticks:{color:"rgb(148, 149, 152)",font:{family:"Commissioner",size:12},callback:function(e){return void 0!==e?l(e):""}},beginAtZero:!1,position:"right",border:{display:!1},grid:{color:"#949598",lineWidth:.6}},x:{ticks:{align:"start",autoSkip:!0,maxTicksLimit:6,color:"rgb(148, 149, 152)",font:{family:"Commissioner",size:12},padding:0,maxRotation:0,minRotation:0},grid:{display:!1}}}}}),p(),window.addEventListener("resize",p),"24h"===s){let $=Math.min(...c),h=Math.max(...c);if(t.textContent=`$${$?l($):"--"}`,i.textContent=`$${h?l(h):"--"}`,h-$!=0){let f=(r-$)/(h-$)*100;f>100&&(f=100),e.style.width=`${f}%`}else e.style.width="0%"}}else y.fillText("Error loading data",u.width/2-50,u.height/2)}).catch(e=>{console.error("Error fetching data:",e),y.fillText("Error loading data",u.width/2-50,u.height/2)})})(n,y,o.getAttribute("data-period"),o.getAttribute("data-coin-api-id"),o.getAttribute("data-coin-api-type"))})}),document.querySelector('.coin__tab.history_price[data-period="24h"]').click();let g=document.querySelector(".coin__tab.history_price.all_time"),$=g.getAttribute("data-coin-api-id"),h=g.getAttribute("data-coin-api-type"),f=document.getElementById("coinChartAllHistoryPrice"),_=f.getContext("2d");f.height=80,fetch(`https://coinyoyo.io/coin-price-history?coinId=${$}&type=${h}&period=all`).then(e=>e.json()).then(e=>{if("success"===e.status){let t=e.data.history;t.sort((e,t)=>e.timestamp-t.timestamp);let i=t.filter(e=>null!==e.price),r=i.map(e=>e.price),o=[...new Set(i.map(e=>new Date(1e3*e.timestamp).getFullYear()))],n=i.map(e=>{let t=new Date(1e3*e.timestamp);return 1===o.length?t.toLocaleDateString("en-GB",{month:"short",year:"numeric"}):t.getFullYear()});function a(){let e=window.innerWidth<600;allTimeChart&&allTimeChart.options&&allTimeChart.options.scales&&allTimeChart.options.scales.x&&(allTimeChart.options.scales.x.ticks.maxTicksLimit=e?4:6,allTimeChart.update())}allTimeChart=new Chart(_,{type:"line",data:{labels:n,datasets:[{data:r,borderColor:"#3c86fe",borderWidth:2,fill:!1,pointRadius:0,pointHoverRadius:0,lineTension:.1}]},options:{animation:{duration:0},interaction:{mode:"nearest",axis:"x",intersect:!1},tooltip:{enabled:!1},responsive:!0,maintainAspectRatio:!1,scales:{y:{display:!0,position:"right",grid:{display:!1},ticks:{color:"transparent",font:{family:"Commissioner",size:12}},border:{display:!1}},x:{ticks:{align:"start",autoSkip:!0,maxTicksLimit:6,color:"rgb(148, 149, 152)",font:{family:"Commissioner",size:12}},grid:{color:"#5b5c61",lineWidth:.4},border:{color:"#5b5c61",width:.4}}},plugins:{legend:{display:!1},tooltip:{enabled:!1},crosshair:!1}}}),a(),window.addEventListener("resize",a)}});let b=document.getElementById("currency-label"),v=document.getElementById("currency-dropdown"),L=document.getElementById("current-currency");b.addEventListener("click",function(e){e.stopPropagation(),v.classList.contains("show")?(v.classList.remove("show"),setTimeout(()=>{v.style.display="none"},300)):(v.style.display="block",setTimeout(()=>{v.classList.add("show")},10))}),document.addEventListener("click",function(e){!v.contains(e.target)&&e.target!==b&&v.classList.contains("show")&&(v.classList.remove("show"),setTimeout(()=>{v.style.display="none"},300))}),v.addEventListener("click",function(e){if("li"===e.target.tagName.toLowerCase()){let t=e.target.getAttribute("data-currency-symbol"),i=e.target.getAttribute("data-currency-price-to-usd");L.textContent=t,o.setAttribute("data-coin-price-currency-to-usd",i),a();let r=v.querySelectorAll("li");r.forEach(e=>{e.classList.remove("selected")}),e.target.classList.add("selected"),v.classList.remove("show"),setTimeout(()=>{v.style.display="none"},300)}})});